
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>The Basics &#8212; DOLfYN 0.12 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/js/versionwarning.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Structure" href="data-structure.html" />
    <link rel="prev" title="Download and Install" href="install.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="the-basics">
<span id="usage"></span><h1>The Basics<a class="headerlink" href="#the-basics" title="Permalink to this headline">¶</a></h1>
<p>DOLfYN is a library of tools for reading, processing, and analyzing
data from oceanographic velocity measurement instruments such as
acoustic Doppler velocimeters (ADVs) and acoustic Doppler profilers
(ADPs). This page documents general and basic usage of the DOLfYN package.</p>
<div class="section" id="reading-source-data-files">
<h2>Reading source data files<a class="headerlink" href="#reading-source-data-files" title="Permalink to this headline">¶</a></h2>
<p>To begin, we load the DOLfYN module and read a data file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dolfyn</span> <span class="k">as</span> <span class="nn">dlfn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span> <span class="o">=</span> <span class="n">dlfn</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="o">&lt;</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">my_data_file</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>In an interactive shell, typing the variable name followed by enter/return will display information about the data object, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span>
<span class="go">&lt;ADV data object&gt;</span>
<span class="go">  . 1.05 hours (started: Jun 12, 2012 12:00)</span>
<span class="go">  . INST-frame</span>
<span class="go">  . (120530 pings @ 32Hz)</span>
<span class="go">  *------------</span>
<span class="go">  | mpltime                  : &lt;time_array; (120530,); float64&gt;</span>
<span class="go">  | vel                      : &lt;array; (3, 120530); float32&gt;</span>
<span class="go">  + config                   : + DATA GROUP</span>
<span class="go">  + env                      : + DATA GROUP</span>
<span class="go">  + orient                   : + DATA GROUP</span>
<span class="go">  + props                    : + DATA GROUP</span>
<span class="go">  + signal                   : + DATA GROUP</span>
<span class="go">  + sys                      : + DATA GROUP</span>
</pre></div>
</div>
<p>This view reveals a few detailed attributes of the data object (above line), and the underlying data structure (below). The attributes indicate that this ADV dataset is 3.02 seconds long, started at noon on June 12, 2012, is in the ‘instrument’ reference-frame, and contains 99 pings at a 32Hz sample-rate. The information below the line shows the variable names in the ADV dataset. <code class="docutils literal notranslate"><span class="pre">mpltime</span></code> is a <code class="xref py py-class docutils literal notranslate"><span class="pre">time_array</span></code> that contains the time information in <a class="reference external" href="https://matplotlib.org/api/dates_api.html#matplotlib.dates.date2num">MatPlotLib date</a> format. <code class="docutils literal notranslate"><span class="pre">vel</span></code> is the velocity data. The other entries (with <code class="docutils literal notranslate"><span class="pre">+</span></code> next to them) are ‘data groups’, which contain additional data. These variables can be accessed using dict-style syntax, <em>or</em> attribute-style syntax. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span><span class="p">[</span><span class="s1">&#39;mpltime&#39;</span><span class="p">]</span>
<span class="go">time_array([734666.50003436, 734666.50003472, 734666.50003509, ...,</span>
<span class="go">            734666.54362775, 734666.54362811, 734666.54362847])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span><span class="o">.</span><span class="n">vel</span>
<span class="go">array([[-1.0020001 , -1.008     , -0.94400007, ...,  0.83100003,</span>
<span class="go">        -2.305     ,  5.177     ],</span>
<span class="go">       [ 0.097     ,  0.068     ,  0.066     , ..., -2.275     ,</span>
<span class="go">         0.86300004, -3.6950002 ],</span>
<span class="go">       [ 0.115     ,  0.12400001,  0.12200001, ...,  0.596     ,</span>
<span class="go">         0.22700001,  0.16600001]], dtype=float32)</span>
</pre></div>
</div>
<p>Interactive display of a data group will reveal the variables the group contains:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span><span class="o">.</span><span class="n">orient</span>
<span class="go">&lt;class &#39;dolfyn.data.base.TimeData&#39;&gt;: Data Object with Keys:</span>
<span class="go">  *------------</span>
<span class="go">  | heading                  : &lt;array; (120530,); float32&gt;</span>
<span class="go">  | orientation_down         : &lt;array; (120530,); bool&gt;</span>
<span class="go">  | pitch                    : &lt;array; (120530,); float32&gt;</span>
<span class="go">  | roll                     : &lt;array; (120530,); float32&gt;</span>
</pre></div>
</div>
<p>Note here that the display information includes the size of each array, and its data-type. The units of most variables are in the <em>MKS</em> system (e.g., velocity is in meters-per-second), and angles are in degrees. See the <a class="reference internal" href="data-structure.html#units"><span class="std std-ref">Data Description and Units</span></a> section for a complete list of the units of DOLfYN variables.</p>
</div>
<div class="section" id="data-groups">
<h2>Data Groups<a class="headerlink" href="#data-groups" title="Permalink to this headline">¶</a></h2>
<p>The data in data objects is organized into data groups to facilitate easier viewing, and to streamline file I/O during advanced processing steps (i.e., so that you only load the data you need). The</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">config</span></code>: this data group contains instrument-configuration data that was loaded from the source file. This is a long list of information that (<em>mostly</em>) inherits attribute names from the manufacturers documentation (i.e., see that documentation for info on these variables).</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">env</span></code>: contains <em>environmental</em> data such as temperature, pressure, or the speed of sound:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;dolfyn.data.base.TimeData&#39;&gt;: Data Object with Keys:
 *------------
 | c_sound                  : &lt;array; (120530,); float32&gt;
 | pressure                 : &lt;array; (120530,); float64&gt;
 | temp                     : &lt;array; (120530,); float32&gt;
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">orient</span></code>: contains orientation data such as pitch, roll, and heading (shown above).</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">props</span></code>: is a dictionary containing information about the data object that is used and modified by/within DOLfYN:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span><span class="o">.</span><span class="n">props</span>
<span class="go">{&#39;coord_sys&#39;: &#39;inst&#39;,</span>
<span class="go"> &#39;fs&#39;: 32,</span>
<span class="go"> &#39;has imu&#39;: False,</span>
<span class="go"> &#39;inst_make&#39;: &#39;Nortek&#39;,</span>
<span class="go"> &#39;inst_model&#39;: &#39;VECTOR&#39;,</span>
<span class="go"> &#39;inst_type&#39;: &#39;ADV&#39;,</span>
<span class="go"> &#39;rotate_vars&#39;: {&#39;vel&#39;}}</span>
</pre></div>
</div>
</li>
</ul>
<p>Here we see that the <code class="docutils literal notranslate"><span class="pre">props</span></code> attribute contains the <cite>‘coord_sys’</cite> entry, which is the ‘coordinate system’ or ‘reference frame’ of the data (see the <a class="reference internal" href="rotations.html#rotations"><span class="std std-ref">Rotations and Coordinate Systems</span></a> section for more information on coordinate systems). It also includes the data sample-rate (32 Hz), and indicates whether this instrument has an ‘inertial motion unit’ or ‘IMU’ (it doesn’t). The instrument manufacturer, model, and type are also included here. The last entry is the <cite>‘rotate_vars’</cite> entry, which lists the vector-variables that should be rotated when rotating this data object (again, see the <a class="reference internal" href="rotations.html#rotations"><span class="std std-ref">Rotations and Coordinate Systems</span></a> section).</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">signal</span></code>: contains information about the amplitude and quality (e.g., correlation) of the acoustic signal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;dolfyn.data.base.TimeData&#39;&gt;: Data Object with Keys:
  *------------
  | amp                      : &lt;array; (3, 120530); uint8&gt;
  | corr                     : &lt;array; (3, 120530); uint8&gt;
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">sys</span></code>: contains system status information such as battery levels, and error codes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;dolfyn.data.base.TimeData&#39;&gt;: Data Object with Keys:
  *------------
  | batt                     : &lt;array; (120530,); float32&gt;
  | error                    : &lt;array; (120530,); uint8&gt;
  | status                   : &lt;array; (120530,); uint8&gt;
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="subsetting-data">
<h2>Subsetting data<a class="headerlink" href="#subsetting-data" title="Permalink to this headline">¶</a></h2>
<p>A segment of the time-record of a data object can be extracted to a new data object using the <code class="docutils literal notranslate"><span class="pre">subset</span></code> property, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">datsub</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">subset</span><span class="p">[:</span><span class="mi">1000</span><span class="p">]</span>
</pre></div>
</div>
<p>Returns a new data object with a copy of the first one-thousand time-steps from the original data object.</p>
<p>The subset property is actually an indexing-object that takes a <em>one-dimensional</em> <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/arrays.indexing.html">numpy-compatible indexing object</a> such as slices and boolean arrays. For example, we can also do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">datsub</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">subset</span><span class="p">[</span>
<span class="go">                  (datetime(2012,6,12,0,1) &lt; dat.mpltime.datetime) &amp;</span>
<span class="go">                  (dat.mpltime.datetime &lt; datetime(2012,6,12,12,0,3))]</span>
</pre></div>
</div>
<p>This gives a data with data from the original for the two seconds between 12:00:01 and 12:00:03 on June 12, 2012. This also reveals the <code class="docutils literal notranslate"><span class="pre">.datetime</span></code> property of the <code class="docutils literal notranslate"><span class="pre">time_array</span></code> class, but this functionality may change.</p>
</div>
<div class="section" id="saving-and-loading-data">
<h2>Saving and loading data<a class="headerlink" href="#saving-and-loading-data" title="Permalink to this headline">¶</a></h2>
<p>A data object can be saved for later use using the <code class="docutils literal notranslate"><span class="pre">to_hdf5</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span><span class="o">.</span><span class="n">to_hdf5</span><span class="p">(</span><span class="s1">&#39;my_data_file.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To load this data into memory (e.g., in a different script), use DOLfYN’s load function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dat2</span> <span class="o">=</span> <span class="n">dlfn</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;my_data_file.h5&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="cleaning-data">
<h2>Cleaning data<a class="headerlink" href="#cleaning-data" title="Permalink to this headline">¶</a></h2>
<p>DOLfYN includes tools for cleaning ADV data in the <cite>dlfn.adv.clean</cite> module. Take a look at those functions for more details. Tools for cleaning ADP data have not yet been developed.</p>
</div>
<div class="section" id="averaging-data">
<h2>Averaging data<a class="headerlink" href="#averaging-data" title="Permalink to this headline">¶</a></h2>
<p>DOLfYN includes tools for averaging data and computing turbulence
statistics from ADV and ADP data. These tools are Python classes
(‘averaging objects’) that are initialized with specific averaging
window details, and then you call methods of the averaging object to
compute averages or turbulence statistics. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># First initalize the averaging tool</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">avg_tool</span> <span class="o">=</span> <span class="n">dlfn</span><span class="o">.</span><span class="n">VelBinner</span><span class="p">(</span><span class="mi">4800</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Then compute averages of all variables in dat</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">avg_dat</span> <span class="o">=</span> <span class="n">avg_tool</span><span class="o">.</span><span class="n">do_avg</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we have initialized an averaging tool, <cite>avg_tool</cite>, to bin 16 Hz data into 4800-point segments (5 minutes). Then when we call the <cite>do_avg</cite> method in the averaging tool on a data object, it returns an ‘averaged’ data object, where all the data field names are the same, but the fields contain averaged data. The averaging tool also includes many other tools (methods) for computing statistics other than averages, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the power-spectral-density of the velocity data, and store it in</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">avg_dat</span><span class="p">[</span><span class="s1">&#39;Spec.vel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">avg_tool</span><span class="o">.</span><span class="n">psd</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="s1">&#39;vel&#39;</span><span class="p">])</span>

<span class="c1"># Compute the Reynold&#39;s stresses (cross-correlations) of the velocity data:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">avg_dat</span><span class="p">[</span><span class="s1">&#39;stress&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">avg_tool</span><span class="o">.</span><span class="n">calc_stress</span><span class="p">(</span><span class="n">dat</span><span class="p">[</span><span class="s1">&#39;vel&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>There is also the <code class="xref py py-class docutils literal notranslate"><span class="pre">TurbBinner</span></code>, which is based on
<code class="xref py py-class docutils literal notranslate"><span class="pre">VelBinner</span></code>, and has several methods for computing additional
statistics from ADV data. Take a look at the API documentation for both of
those tools for more details.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">DOLfYN</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Download and Install</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reading-source-data-files">Reading source data files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-groups">Data Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="#subsetting-data">Subsetting data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#saving-and-loading-data">Saving and loading data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cleaning-data">Cleaning data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#averaging-data">Averaging data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data-structure.html">Data Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="rotations.html">Rotations and Coordinate Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="motion-correction.html">Motion Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting-tools.html">Plotting Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">The DOLfYN API</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="install.html" title="previous chapter">Download and Install</a></li>
      <li>Next: <a href="data-structure.html" title="next chapter">Data Structure</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Levi Kilcher.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/usage.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>