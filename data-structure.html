
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Data Structure &#8212; DOLfYN 0.10.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Motion Correction" href="motion-correction.html" />
    <link rel="prev" title="The Basics" href="usage.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="data-structure">
<h1>Data Structure<a class="headerlink" href="#data-structure" title="Permalink to this headline">¶</a></h1>
<p>DOLfYN data objects are built on (subclasses of) <a class="reference external" href="http://github.com/lkilcher/pyDictH5">pyDictH5</a> data objects, which are themselves subclasses of Python dictionaries. As such, these objects support all of the same basic functionality of dictionaries (e.g., indexing, iterating, etc.), with additional functionality that is designed to streamline the process of analyzing and working with data. Most notably, these data objects provide:</p>
<ul>
<li><p class="first">a summarized view of the data structure when in interactive mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span>
<span class="go">&lt;ADV data object&gt;</span>
<span class="go">  . 1.05 hours (started: Jun 12, 2012 12:00)</span>
<span class="go">  . EARTH-frame</span>
<span class="go">  . (120530 pings @ 32Hz)</span>
<span class="go">  *------------</span>
<span class="go">  | mpltime                  : &lt;time_array; (120530,); float64&gt;</span>
<span class="go">  | vel                      : &lt;array; (3, 120530); float32&gt;</span>
<span class="go">  + config                   : + DATA GROUP</span>
<span class="go">  + env                      : + DATA GROUP</span>
<span class="go">  + orient                   : + DATA GROUP</span>
<span class="go">  + props                    : + DATA GROUP</span>
<span class="go">  + signal                   : + DATA GROUP</span>
<span class="go">  + sys                      : + DATA GROUP</span>
</pre></div>
</div>
</li>
<li><p class="first">attribute-style syntax (<code class="docutils literal notranslate"><span class="pre">dat.vel</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">dat['vel']</span></code>)</p>
</li>
<li><p class="first">direct access of items within sub-groups (<code class="docutils literal notranslate"><span class="pre">dat['env.temp']</span></code> works, and <code class="docutils literal notranslate"><span class="pre">'env.temp'</span> <span class="pre">in</span> <span class="pre">dat</span></code> evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p>
</li>
</ul>
<p>See the <a class="reference external" href="https://github.com/lkilcher/pyDictH5/blob/master/README.rst">pyDictH5 README</a> for additional details.</p>
<div class="section" id="rotations-and-coordinate-systems">
<span id="rotations"></span><h2>Rotations and Coordinate Systems<a class="headerlink" href="#rotations-and-coordinate-systems" title="Permalink to this headline">¶</a></h2>
<p>Coordinate systems (a.k.a. reference frames) specify the coordinate directions of vector data in the data object. The values in the list <cite>dat.props[‘rotate_vars’]</cite> specifies the vectors that are rotated when changing between different coordinate systems. <strong>You can also create `dat._rotate_*` functions to perform additional rotation operations. I need to document these!</strong></p>
<p>The first dimension of these vectors are the coordinate systems. DOLfYN supports four primary coordinate systems:</p>
<ul>
<li><p class="first"><strong>BEAM</strong>: this is the coordinate system of the ‘along-beam’ velocities. When a data object is in this coordinate system, only the velocity data (i.e., the variables in <cite>dat.props[‘rotate_vars’]</cite> starting with ‘<cite>vel’</cite>) is in beam coordinates. Other vector variables listed in <cite>‘rotate_vars’</cite> (e.g., <cite>dat.orient.AngRt</cite>, for instruments with IMUs) are in the INST frame. This coordinate system is <em>not</em> ortho-normal. When the data object is in BEAM coordinates, the first dimension of the velocity vectors are: [beam1, beam2, … beamN].</p>
</li>
<li><p class="first"><strong>INST</strong>: this is the ‘instrument’ coordinate system defined by the manufacturer. This coordinate system is orth-normal,  but is not necessarily fixed. That is, if the instrument is rotating, then this coordinate system changes relative to the earth. When the data object is in INST coordinates, the first dimension of the vectors are: [X, Y, Z, …].</p>
<p>Note: instruments with more than three beams will have more than three coordinate directions. See the documentation for your specific instrument to see how ‘extra’ dimensions are handled by DOLfYN. <strong>I need to update this more</strong>.</p>
</li>
<li><p class="first"><strong>EARTH</strong>: the earth coordinate system is the ‘rotationally-fixed’ coordinate system. This coordinate system is ‘fixed’ in the sense that it does not rotate, but it may not be ‘stationary’ if the instrument slides around translationally (see the <a class="reference internal" href="motion-correction.html#motion-correction"><span class="std std-ref">Motion Correction</span></a> section for details on how to correct for translational motion). When the data object is in EARTH coordinates, the first dimension of the vectors are: [East, North, Up, …].</p>
</li>
<li><p class="first"><strong>PRINCIPAL</strong>: the principal coordinate system is similar to the earth coordinate system (it is fixed), but it has been rotated in the horizontal plane to align with the flow in one way or another. In this coordinate system the first dimension of the vectors are: [Stream-wise, Cross-stream, Up]. By default, the stream-wise direction is determined using the <cite>:func:&lt;data.velocity.calc_principal_angle&gt;</cite> function. Or, you can specify the rotation direction directly by setting <cite>dat.props[‘principal_angle’]</cite> to the rotation angle by which you want to rotate the horizontal velocity, in units of radians. This direction (positive counter-clockwise from east) will be the first row of vectors (i.e., the <em>Streamwise</em> direction).</p>
</li>
</ul>
<p>To rotate a data object into one of these coordinate systems, simply use the <cite>rotate2</cite> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dat_earth</span> <span class="o">=</span> <span class="n">dat</span><span class="o">.</span><span class="n">rotate2</span><span class="p">(</span><span class="s1">&#39;earth&#39;</span><span class="p">)</span>  <span class="c1"># (&quot;rotate to earth&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dat_earth</span>
<span class="go">&lt;ADV data object&gt;</span>
<span class="go">  . 1.05 hours (started: Jun 12, 2012 12:00)</span>
<span class="go">  . EARTH-frame</span>
<span class="go">  . (120530 pings @ 32Hz)</span>
<span class="go">  *------------</span>
<span class="go">  | mpltime                  : &lt;time_array; (120530,); float64&gt;</span>
<span class="go">  | vel                      : &lt;array; (3, 120530); float32&gt;</span>
<span class="go">  + config                   : + DATA GROUP</span>
<span class="go">  + env                      : + DATA GROUP</span>
<span class="go">  + orient                   : + DATA GROUP</span>
<span class="go">  + props                    : + DATA GROUP</span>
<span class="go">  + signal                   : + DATA GROUP</span>
<span class="go">  + sys                      : + DATA GROUP</span>
</pre></div>
</div>
</div>
<div class="section" id="data-description-and-units">
<span id="units"></span><h2>Data Description and Units<a class="headerlink" href="#data-description-and-units" title="Permalink to this headline">¶</a></h2>
<p>DOLfYN generally uses the <a class="reference external" href="https://en.wikipedia.org/wiki/MKS_system_of_units">*MKS* system</a>, with most angles in degrees.</p>
<table border="1" class="colwidths-given docutils" id="id1">
<caption><span class="caption-text">Table 1: The units of common variables found in DOLfYN data objects.</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="15%" />
<col width="20%" />
<col width="15%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Units</th>
<th class="head">Group</th>
<th class="head">Description/Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>mpltime</td>
<td><a class="reference external" href="https://matplotlib.org/api/dates_api.html#matplotlib.dates.date2num">matplotlib date format</a></td>
<td>—</td>
<td>The time data</td>
</tr>
<tr class="row-odd"><td>vel</td>
<td>m/s</td>
<td>—</td>
<td>The velocity vector data</td>
</tr>
<tr class="row-even"><td>range</td>
<td>m</td>
<td>—</td>
<td>The distance from the ADP head</td>
</tr>
<tr class="row-odd"><td>c_sound</td>
<td>m/s</td>
<td>env</td>
<td>The speed of sound used in velocity calculations.</td>
</tr>
<tr class="row-even"><td>press / pressure</td>
<td>dbar?</td>
<td>env</td>
<td>pressure measured by the instrument</td>
</tr>
<tr class="row-odd"><td>temp</td>
<td>degrees Celsius</td>
<td>env</td>
<td>The temperature measured by the instrument.</td>
</tr>
<tr class="row-even"><td>accel</td>
<td>m/s<sup>2</sup></td>
<td>orient</td>
<td>The vector acceleraton of the instrument</td>
</tr>
<tr class="row-odd"><td>angrt</td>
<td>rad/s</td>
<td>orient</td>
<td>The angular rotation rate of the instrument</td>
</tr>
<tr class="row-even"><td>mag</td>
<td>???</td>
<td>orient</td>
<td>The magnetometer data.</td>
</tr>
<tr class="row-odd"><td>velraw</td>
<td>m/s</td>
<td>—</td>
<td>The velocity without motion-correction.</td>
</tr>
<tr class="row-even"><td>velrot</td>
<td>m/s</td>
<td>orient</td>
<td>The rotational motion velocity (computed from angrt).</td>
</tr>
<tr class="row-odd"><td>velacc</td>
<td>m/s</td>
<td>orient</td>
<td>The translational motion velocity (computed from accel).</td>
</tr>
<tr class="row-even"><td>acclow</td>
<td>m/s<sup>2</sup></td>
<td>orient</td>
<td>The low-pass filtered acceleration signal.</td>
</tr>
<tr class="row-odd"><td>heading</td>
<td>degrees</td>
<td>orient</td>
<td>The instrument heading* (clockwise from North)</td>
</tr>
<tr class="row-even"><td>pitch</td>
<td>degrees</td>
<td>orient</td>
<td>The instrument pitch*</td>
</tr>
<tr class="row-odd"><td>roll</td>
<td>degrees</td>
<td>orient</td>
<td>The instrument roll*</td>
</tr>
<tr class="row-even"><td>orientmat</td>
<td>—</td>
<td>orient</td>
<td>The instrument’s orientation matrix in the earth reference frame</td>
</tr>
<tr class="row-odd"><td>amp</td>
<td>???</td>
<td>signal</td>
<td>The acoustic signal return amplitude</td>
</tr>
<tr class="row-even"><td>corr</td>
<td>percent</td>
<td>signal</td>
<td>correlation between the send and receive pings.</td>
</tr>
<tr class="row-odd"><td>ambig_vel</td>
<td>m/s</td>
<td>sys</td>
<td>The ambiguity velocity*</td>
</tr>
<tr class="row-even"><td>batt_V / batt</td>
<td>voltage</td>
<td>sys</td>
<td>The battery voltage</td>
</tr>
<tr class="row-odd"><td>ensemble</td>
<td>—</td>
<td>sys</td>
<td>The ensemble counter</td>
</tr>
<tr class="row-even"><td>error</td>
<td>—</td>
<td>sys</td>
<td>The instrument error code*</td>
</tr>
<tr class="row-odd"><td>status</td>
<td>—</td>
<td>sys</td>
<td>The instrument status code*</td>
</tr>
<tr class="row-even"><td>temp_clock</td>
<td>degrees C?</td>
<td>sys</td>
<td>The instruments clock temperature</td>
</tr>
<tr class="row-odd"><td>temp_mag</td>
<td>degrees C?</td>
<td>sys</td>
<td>The instruments magnetometer temperature</td>
</tr>
<tr class="row-even"><td>temp_press</td>
<td>degrees C?</td>
<td>sys</td>
<td>The instruments pressure sensor temperature</td>
</tr>
<tr class="row-odd"><td>tke_vec</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td>—</td>
<td>Variance of velocity components (0: uu; 1: vv; 2: ww)</td>
</tr>
<tr class="row-even"><td>stress</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td>—</td>
<td>The Reynolds stress array (0: uv, 1: uw, 2: vw)</td>
</tr>
<tr class="row-odd"><td>sigma_Uh</td>
<td>m/s</td>
<td>—</td>
<td>Standard deviation of horizontal velocity magnitude</td>
</tr>
<tr class="row-even"><td>epsilon</td>
<td>m<sup>2</sup>/s<sup>3</sup></td>
<td>—</td>
<td>Turbulence dissipation rate</td>
</tr>
<tr class="row-odd"><td>Spec</td>
<td>&lt;variables units&gt;<sup>2</sup>/(rad/s)</td>
<td>—</td>
<td>A data group containing spectra of variables above.</td>
</tr>
<tr class="row-even"><td>omega</td>
<td>rad/s</td>
<td>Spec</td>
<td>Radial frequency.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="data-shortcuts-properties">
<h2>Data Shortcuts (properties)<a class="headerlink" href="#data-shortcuts-properties" title="Permalink to this headline">¶</a></h2>
<p>In addition to the data items listed above, DOLfYN data objects also
contain shortcuts to tools and other variables that can be obtained
from simple operations of its data items. These attributes aren’t
listed in the view of the data shown above. Instead, to see the
variables that are available as shortcuts for a particular data
object, take a look at the <code class="docutils literal notranslate"><span class="pre">dat.shortcuts</span></code> property.</p>
<table border="1" class="colwidths-given docutils" id="id2">
<caption><span class="caption-text">Table 2: Notes on common shorcuts found in DOLfYN data objects.</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="13%" />
<col width="17%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">units</th>
<th class="head">Description/Notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>shape</td>
<td>—</td>
<td>the shape of <code class="docutils literal notranslate"><span class="pre">dat.u</span></code> (see below)</td>
</tr>
<tr class="row-odd"><td>n_time</td>
<td>—</td>
<td>the length of <code class="docutils literal notranslate"><span class="pre">dat['mpltime']</span></code></td>
</tr>
<tr class="row-even"><td>u</td>
<td>m/s</td>
<td><code class="docutils literal notranslate"><span class="pre">dat['vel'][0]</span></code></td>
</tr>
<tr class="row-odd"><td>v</td>
<td>m/s</td>
<td><code class="docutils literal notranslate"><span class="pre">dat['vel'][1]</span></code></td>
</tr>
<tr class="row-even"><td>w</td>
<td>m/s</td>
<td><code class="docutils literal notranslate"><span class="pre">dat['vel'][2]</span></code></td>
</tr>
<tr class="row-odd"><td>U</td>
<td>m/s</td>
<td>the horizontal velocity as a complex quantity (dat.u + 1j * dat.v)</td>
</tr>
<tr class="row-even"><td>U_mag</td>
<td>m/s</td>
<td>the magnitude of the horizontal velocity</td>
</tr>
<tr class="row-odd"><td>U_angle</td>
<td>radians</td>
<td>the direction of the horizontal velocity (counter-clockwise from East; X; or streamwise direction; depending on coordinate system)</td>
</tr>
<tr class="row-even"><td>subset</td>
<td>—</td>
<td>a tool for indexing a subset of the data object</td>
</tr>
<tr class="row-odd"><td>tauij</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td>the Reynold’s stress tensor</td>
</tr>
<tr class="row-even"><td>tke</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td>the turbulent kinetic energy (half the sum of the data in <cite>‘tke_vec’</cite>)</td>
</tr>
<tr class="row-odd"><td>upup_</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td><code class="docutils literal notranslate"><span class="pre">dat['tke_vec'][0]</span></code></td>
</tr>
<tr class="row-even"><td>vpvp_</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td><code class="docutils literal notranslate"><span class="pre">dat['tke_vec'][1]</span></code></td>
</tr>
<tr class="row-odd"><td>wpwp_</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td><code class="docutils literal notranslate"><span class="pre">dat['tke_vec'][2]</span></code></td>
</tr>
<tr class="row-even"><td>upvp_</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td><code class="docutils literal notranslate"><span class="pre">dat['stress'][0]</span></code></td>
</tr>
<tr class="row-odd"><td>upwp_</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td><code class="docutils literal notranslate"><span class="pre">dat['stress'][1]</span></code></td>
</tr>
<tr class="row-even"><td>vpwp_</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td><code class="docutils literal notranslate"><span class="pre">dat['stress'][2]</span></code></td>
</tr>
<tr class="row-odd"><td>Ecoh</td>
<td>m<sup>2</sup>/s<sup>2</sup></td>
<td>Coherent turbulent kinetic energy (root-sum-square of Reynold’s stresses)</td>
</tr>
<tr class="row-even"><td>I</td>
<td>—</td>
<td>Ratio of sigma_Uh to horizontal velocity magnitude</td>
</tr>
<tr class="row-odd"><td>Itke</td>
<td>—</td>
<td>Ratio of sqrt(2*tke) to horizontal velocity magnitude</td>
</tr>
</tbody>
</table>
<p><strong>Important Note:</strong> The items listed in Table 2 are not stored in the data
object but are provided as attributes (shortcuts) to DOLfYN data objects.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">DOLfYN</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Download and Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">The Basics</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rotations-and-coordinate-systems">Rotations and Coordinate Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-description-and-units">Data Description and Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-shortcuts-properties">Data Shortcuts (properties)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="motion-correction.html">Motion Correction</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting-tools.html">Plotting Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">The DOLfYN API</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="usage.html" title="previous chapter">The Basics</a></li>
      <li>Next: <a href="motion-correction.html" title="next chapter">Motion Correction</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2014, Levi Kilcher.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/data-structure.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>